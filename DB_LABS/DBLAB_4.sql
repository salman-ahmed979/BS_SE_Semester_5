-- 19K-1043 SALMAN AHMED KHAN DB LAB 4
--1
SELECT DEPARTMENT_ID, COUNT(EMPLOYEE_ID) AS "EMPLOYEE-ID", AVG(SALARY) FROM HR.EMPLOYEES GROUP BY DEPARTMENT_ID;

--2
SELECT JOB_ID AS "JOB_ID", COUNT(EMPLOYEE_ID) FROM HR.EMPLOYEES GROUP BY JOB_ID;

--3
SELECT FIRST_NAME, HIRE_DATE FROM HR.EMPLOYEES WHERE HIRE_DATE > (SELECT HIRE_DATE FROM HR.EMPLOYEES WHERE EMPLOYEE_ID = 110);

--4
SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, JOB_ID FROM HR.EMPLOYEES WHERE SALARY < ANY (SELECT SALARY FROM HR.EMPLOYEES WHERE JOB_ID = 'IT_PROG' );

--5
SELECT DEPARTMENT_ID, COUNT(EMPLOYEE_ID) FROM HR.EMPLOYEES WHERE SALARY > 2000 AND DEPARTMENT_ID IN (SELECT DEPARTMENT_ID FROM HR.EMPLOYEES GROUP BY DEPARTMENT_ID HAVING COUNT(EMPLOYEE_ID) > 5 ) GROUP BY DEPARTMENT_ID;

--6
SELECT FIRST_NAME, LAST_NAME, DEPARTMENT_ID FROM HR.EMPLOYEES WHERE DEPARTMENT_ID IN (SELECT DEPARTMENT_ID FROM HR.EMPLOYEES WHERE LAST_NAME = 'TAYLOR');

--7

UPDATE HR.EMPLOYEES SET SALARY = SALARY + (SALARY *0.2) WHERE SALARY< 6000;

--8

CREATE TABLE HR.EMPLOYEE_BKP AS SELECT * FROM HR.EMPLOYEES;
Insert into HR.EMPLOYEE_BKP (SELECT * FROM HR.EMPLOYEES WHERE HIRE_DATE = (SELECT START_DATE FROM HR.JOB_HISTORY WHERE START_DATE='13-JAN-01'));

--9

DELETE FROM HR.EMPLOYEE_BKP WHERE EMPLOYEE_ID IN (SELECT MANAGER_ID FROM HR.DEPARTMENTS WHERE DEPARTMENT_NAME = 'Finance');