-- LAB 5 
-- 19K1043 SALMAN AHMEED KHAN

--1

SELECT EMPLOYEES.EMPLOYEE_ID, EMPLOYEES.FIRST_NAME, EMPLOYEES.LAST_NAME, DEPARTMENTS.DEPARTMENT_NAME, EMPLOYEES.MANAGER_ID FROM HR.EMPLOYEES, HR.DEPARTMENTS WHERE EMPLOYEES.DEPARTMENT_ID=DEPARTMENTS.DEPARTMENT_ID;

--2

SELECT EMPLOYEES.EMPLOYEE_ID, EMPLOYEES.LAST_NAME, JOBS.JOB_TITLE FROM HR.EMPLOYEES , HR.JOBS WHERE JOBS.JOB_ID = EMPLOYEES.JOB_ID;

--3 Write a query to List the department names and get the count of employees working in each department

SELECT DEPARTMENTS.DEPARTMENT_NAME, COUNT(EMPLOYEES.EMPLOYEE_ID) AS COUNTER FROM HR.DEPARTMENTS, HR.EMPLOYEES WHERE DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID  GROUP BY DEPARTMENTS.DEPARTMENT_NAME;

--4 Write a query to list the department name where at least two employees are working.

SELECT DEPARTMENTS.DEPARTMENT_NAME, COUNT(EMPLOYEES.EMPLOYEE_ID) FROM HR.DEPARTMENTS JOIN HR.EMPLOYEES ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID  
GROUP BY DEPARTMENTS.DEPARTMENT_NAME 
HAVING (COUNT(EMPLOYEES.EMPLOYEE_ID) >= 2);

--5 Write a query to find how many employees are there for each job_title (designation)

SELECT JOBS.JOB_TITLE, COUNT(EMPLOYEES.EMPLOYEE_ID) AS EMPLNO FROM HR.EMPLOYEES JOIN HR.JOBS ON EMPLOYEES.JOB_ID = JOBS.JOB_ID GROUP BY JOBS.JOB_TITLE;

--6 Write a query to show the count of employees working under a manager and 
--  MANAGER ID in ascending order (this is example for self-join) Use the
--  employees table twice in the select clause.

SELECT E1.MANAGER_ID, COUNT(E1.EMPLOYEE_ID) FROM HR.EMPLOYEES E1 JOIN HR.EMPLOYEES E2 ON E1.MANAGER_ID = E2.MANAGER_ID GROUP BY E1.MANAGER_ID;

--7 Write a query to display employee details for all departments (even if there is
--  no employee in a department.

SELECT * FROM HR.EMPLOYEES FULL OUTER JOIN HR.DEPARTMENTS ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;

-- 8 Write a query to display all Employess in 'Marketing’, ‘Executive' departments

SELECT * FROM HR.EMPLOYEES LEFT JOIN HR.DEPARTMENTS ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID WHERE DEPARTMENTS.DEPARTMENT_NAME IN ('Marketing','Executive');

--9 Write a Query and Display the employees (Employee ID, First Name, Last Name
--  and City) and Department Name who are working in Seattle and
--  STATE PROVINCE 'Washington'.

SELECT EMPLOYEES.EMPLOYEE_ID, EMPLOYEES.FIRST_NAME, EMPLOYEES.LAST_NAME,DEPARTMENTS.DEPARTMENT_NAME,
LOCATIONS.CITY
FROM HR.EMPLOYEES 
JOIN HR.DEPARTMENTS 
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID 
JOIN HR.LOCATIONS
ON  LOCATIONS.LOCATION_ID = DEPARTMENTS.LOCATION_Id 
WHERE  LOCATIONS.CITY = 'Seattle' AND LOCATIONS.STATE_PROVINCE = 'Washington';


--10. Write a query to List the distinct job_title from jobs table for employees
--whose department names are not Marketing and Executive Departments.

SELECT DISTINCT JOBS.JOB_TITLE 
FROM HR.JOBS 
JOIN HR.EMPLOYEES 
ON JOBS.JOB_ID = EMPLOYEES.EMPLOYEE_ID
JOIN HR.DEPARTMENTS
ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID
WHERE DEPARTMENTS.DEPARTMENT_NAME<>'Marketing' OR DEPARTMENTS.DEPARTMENT_NAME<>'Executive';